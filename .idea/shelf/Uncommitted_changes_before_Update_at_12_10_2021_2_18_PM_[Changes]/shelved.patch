Index: database.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php\r\nfunction connectToDatabase() {\r\n    $Connection = null;\r\n    mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT); // Set MySQLi to throw exceptions\r\n    try {\r\n        $Connection = mysqli_connect(\"127.0.0.1\", \"root\", \"\", \"nerdygadgets\");\r\n        mysqli_set_charset($Connection, 'latin1');\r\n        $DatabaseAvailable = true;\r\n    } catch (mysqli_sql_exception $e) {\r\n        $DatabaseAvailable = false;\r\n    }\r\n    if (!$DatabaseAvailable) {\r\n        ?><p1>Ik kan helaas niet verbinden met de website, probeer het later nog een keer.</p1><?php\r\n        die();\r\n    }\r\n\r\n    return $Connection;\r\n}\r\nfunction getHeaderStockGroups($databaseConnection) {\r\n    $Query = \"\r\n                SELECT StockGroupID, StockGroupName, ImagePath\r\n                FROM stockgroups \r\n                WHERE StockGroupID IN (\r\n                                        SELECT StockGroupID \r\n                                        FROM stockitemstockgroups\r\n                                        ) AND ImagePath IS NOT NULL\r\n                ORDER BY StockGroupID ASC\";\r\n    $Statement = mysqli_prepare($databaseConnection, $Query);\r\n    mysqli_stmt_execute($Statement);\r\n    $HeaderStockGroups = mysqli_stmt_get_result($Statement);\r\n    return $HeaderStockGroups;\r\n}\r\n\r\nfunction getStockGroups($databaseConnection) {\r\n    $Query = \"\r\n            SELECT StockGroupID, StockGroupName, ImagePath\r\n            FROM stockgroups \r\n            WHERE StockGroupID IN (\r\n                                    SELECT StockGroupID \r\n                                    FROM stockitemstockgroups\r\n                                    ) AND ImagePath IS NOT NULL\r\n            ORDER BY StockGroupID ASC\";\r\n    $Statement = mysqli_prepare($databaseConnection, $Query);\r\n    mysqli_stmt_execute($Statement);\r\n    $Result = mysqli_stmt_get_result($Statement);\r\n    $StockGroups = mysqli_fetch_all($Result, MYSQLI_ASSOC);\r\n    return $StockGroups;\r\n}\r\n\r\nfunction getStockItem($id, $databaseConnection) {\r\n    $Result = null;\r\n\r\n    $Query = \" \r\n           SELECT SI.StockItemID, \r\n            (RecommendedRetailPrice*(1+(TaxRate/100))) AS SellPrice, \r\n            StockItemName,\r\n            CONCAT('Voorraad: ',QuantityOnHand)AS QuantityOnHand,\r\n            SearchDetails, \r\n            (CASE WHEN (RecommendedRetailPrice*(1+(TaxRate/100))) > 50 THEN 0 ELSE 6.95 END) AS SendCosts, MarketingComments, CustomFields, SI.Video,\r\n            (SELECT ImagePath FROM stockgroups JOIN stockitemstockgroups USING(StockGroupID) WHERE StockItemID = SI.StockItemID LIMIT 1) as BackupImagePath   \r\n            FROM stockitems SI \r\n            JOIN stockitemholdings SIH USING(stockitemid)\r\n            JOIN stockitemstockgroups ON SI.StockItemID = stockitemstockgroups.StockItemID\r\n            JOIN stockgroups USING(StockGroupID)\r\n            WHERE SI.stockitemid = ?\r\n            GROUP BY StockItemID\";\r\n\r\n    $Statement = mysqli_prepare($databaseConnection, $Query);\r\n    mysqli_stmt_bind_param($Statement, \"i\", $id);\r\n    mysqli_stmt_execute($Statement);\r\n    $ReturnableResult = mysqli_stmt_get_result($Statement);\r\n    if ($ReturnableResult && mysqli_num_rows($ReturnableResult) == 1) {\r\n        $Result = mysqli_fetch_all($ReturnableResult, MYSQLI_ASSOC)[0];\r\n    }\r\n\r\n    return $Result;\r\n}\r\n\r\nfunction getStockItemImage($id, $databaseConnection) {\r\n\r\n    $Query = \"\r\n                SELECT ImagePath\r\n                FROM stockitemimages \r\n                WHERE StockItemID = ?\";\r\n\r\n    $Statement = mysqli_prepare($databaseConnection, $Query);\r\n    mysqli_stmt_bind_param($Statement, \"i\", $id);\r\n    mysqli_stmt_execute($Statement);\r\n    $R = mysqli_stmt_get_result($Statement);\r\n    $R = mysqli_fetch_all($R, MYSQLI_ASSOC);\r\n\r\n    return $R;\r\n}\r\n\r\nfunction getItemDetails($id,$databaseConnection) {\r\n    $query = \"\r\n                    SELECT SI.StockItemID, SI.StockItemName, SI.MarketingComments, TaxRate, RecommendedRetailPrice,\r\n                    ROUND(SI.TaxRate * SI.RecommendedRetailPrice  / 100 + SI.RecommendedRetailPrice,2) as SellPrice,\r\n                    QuantityOnHand,\r\n                    (SELECT ImagePath FROM stockitemimages WHERE StockItemID  = SI.StockItemID  LIMIT 1) as ImagePath,\r\n                    (SELECT ImagePath FROM stockgroups JOIN stockitemstockgroups USING(StockGroupID) WHERE StockGroupID = SI.StockItemID LIMIT 1) as BackupImagePath\r\n                    FROM stockitems AS SI\r\n                    JOIN stockitemholdings SIH USING(stockitemid)\r\n                    JOIN stockitemstockgroups USING(StockItemID)\r\n                    JOIN stockgroups ON stockitemstockgroups.StockGroupID = stockgroups.StockGroupID\r\n                    WHERE SI.StockItemID = $id\r\n                    GROUP BY StockItemID\";\r\n\r\n    $statement = mysqli_prepare($databaseConnection, $query);\r\n    mysqli_stmt_execute($statement);\r\n    $output = mysqli_stmt_get_result($statement);\r\n    $output = mysqli_fetch_all($output,MYSQLI_ASSOC);\r\n\r\n    return $output[0];\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/database.php b/database.php
--- a/database.php	(revision 0ba07923cf511cd757ef137fcc7c1d6d019c7f7d)
+++ b/database.php	(date 1639142322564)
@@ -10,7 +10,7 @@
         $DatabaseAvailable = false;
     }
     if (!$DatabaseAvailable) {
-        ?><p1>Ik kan helaas niet verbinden met de website, probeer het later nog een keer.</p1><?php
+        ?><p1>Stop met dat wachtwoord er in zetten.</p1><?php
         die();
     }
 
@@ -113,3 +113,57 @@
 
     return $output[0];
 }
+
+function login($email,$password,$databaseConnection) {
+    $query = "
+                    SELECT CustomerID
+                    FROM account
+                    WHERE Email = '$email' AND WHERE Password = '$password'
+                    ";
+    $statement = mysqli_prepare($databaseConnection, $query);
+    mysqli_stmt_execute($statement);
+    $output = mysqli_stmt_get_result($statement);
+    $output = mysqli_fetch_all($output,MYSQLI_ASSOC);
+
+    foreach($output as $key => $value) {
+        if(empty($value)) {
+            unset($output[$key]);
+        }
+    }
+
+    if(!empty($output)) {
+        $loginsucces = TRUE;
+    } else {
+        $loginsucces = FALSE;
+    }
+    print_R($output);
+    return($loginsucces);
+}
+
+function temperatuur($databaseConnection) {
+    $query = " SELECT coldroomtemperatures.Temperature
+               FROM nerdygadgets.coldroomtemperatures
+               WHERE (SELECT MAX(coldroomtemperatures.RecordedWhen)
+                      FROM nerdygadgets.coldroomtemperatures
+                      GROUP BY coldroomtemperatures.RecordedWhen
+                      ORDER  BY coldroomtemperatures.RecordedWhen)";
+
+    $statement = mysqli_prepare($databaseConnection, $query);
+    mysqli_stmt_execute($statement);
+    $resultaat = mysqli_stmt_get_result($statement);
+    $resultaat = mysqli_fetch_all($resultaat,MYSQLI_ASSOC);
+
+
+        if(empty($resultaat)) {
+            print ("Kan geen temperatuur ophalen");
+        }
+        else {
+            print("de huidige temperatuur van dit product is) . pr;
+        }
+
+
+
+
+
+
+}
\ No newline at end of file
Index: view.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php\r\ninclude __DIR__ . \"/header.php\";\r\n\r\n$StockItem = getStockItem($_GET['id'], $databaseConnection);\r\n$StockItemImage = getStockItemImage($_GET['id'], $databaseConnection);\r\n\r\n#Functions\r\nfunction getVoorraadTekst($actueleVoorraad)\r\n{\r\n    if ($actueleVoorraad > 1000) {\r\n        return \"Ruime voorraad beschikbaar\";\r\n    } else {\r\n        return (\"$actueleVoorraad\");\r\n    }\r\n}\r\n\r\n?>\r\n<div id=\"CenteredContent\">\r\n    <?php\r\n    if ($StockItem != null) {\r\n        ?>\r\n        <?php\r\n        if (isset($StockItem['Video'])) {\r\n            ?>\r\n            <div id=\"VideoFrame\">\r\n                <?php print $StockItem['Video']; ?>\r\n            </div>\r\n        <?php }\r\n        ?>\r\n\r\n\r\n        <div id=\"ArticleHeader\">\r\n            <?php\r\n            if (isset($StockItemImage)) {\r\n                // één plaatje laten zien\r\n                if (count($StockItemImage) == 1) {\r\n                    ?>\r\n                    <div id=\"ImageFrame\"\r\n                         style=\"background-image: url('public/stockitemimg/<?php print $StockItemImage[0]['ImagePath']; ?>'); background-size: 300px; background-repeat: no-repeat; background-position: center;\"></div>\r\n                    <?php\r\n                } else if (count($StockItemImage) >= 2) { ?>\r\n                    <!-- meerdere plaatjes laten zien -->\r\n                    <div id=\"ImageFrame\">\r\n                        <div id=\"ImageCarousel\" class=\"carousel slide\" data-interval=\"false\">\r\n                            <!-- Indicators -->\r\n                            <ul class=\"carousel-indicators\">\r\n                                <?php for ($i = 0; $i < count($StockItemImage); $i++) {\r\n                                    ?>\r\n                                    <li data-target=\"#ImageCarousel\"\r\n                                        data-slide-to=\"<?php print $i ?>\" <?php print (($i == 0) ? 'class=\"active\"' : ''); ?>></li>\r\n                                    <?php\r\n                                } ?>\r\n                            </ul>\r\n\r\n                            <!-- slideshow -->\r\n                            <div class=\"carousel-inner\">\r\n                                <?php for ($i = 0; $i < count($StockItemImage); $i++) {\r\n                                    ?>\r\n                                    <div class=\"carousel-item <?php print ($i == 0) ? 'active' : ''; ?>\">\r\n                                        <img src=\"public/stockitemimg/<?php print $StockItemImage[$i]['ImagePath'] ?>\">\r\n                                    </div>\r\n                                <?php } ?>\r\n                            </div>\r\n\r\n                            <!-- knoppen 'vorige' en 'volgende' -->\r\n                            <a class=\"carousel-control-prev\" href=\"#ImageCarousel\" data-slide=\"prev\">\r\n                                <span class=\"carousel-control-prev-icon\"></span>\r\n                            </a>\r\n                            <a class=\"carousel-control-next\" href=\"#ImageCarousel\" data-slide=\"next\">\r\n                                <span class=\"carousel-control-next-icon\"></span>\r\n                            </a>\r\n                        </div>\r\n                    </div>\r\n                    <?php\r\n                }\r\n            } else {\r\n                ?>\r\n                <div id=\"ImageFrame\"\r\n                     style=\"background-image: url('public/stockgroupimg/<?php print $StockItem['BackupImagePath']; ?>'); background-size: cover;\"></div>\r\n                <?php\r\n            }\r\n            ?>\r\n            <h1 class=\"StockItemID\">Artikelnummer: <?php print $StockItem[\"StockItemID\"]; ?></h1>\r\n            <h2 class=\"StockItemNameViewSize StockItemName2\">\r\n                <?php print $StockItem['StockItemName']; ?>\r\n            </h2>\r\n            <div class=\"QuantityText\"><?= getVoorraadTekst($StockItem['QuantityOnHand']); ?></div>\r\n            <div id=\"StockItemHeaderLeft\">\r\n                <div class=\"CenterPriceLeft\">\r\n                    <div class=\"CenterPriceLeftChild\">\r\n                        <p class=\"StockItemPriceText\"><b><?php print sprintf(\"€ %.2f\", $StockItem['SellPrice']); ?></b></p>\r\n                        <h6> Inclusief BTW </h6>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div id=\"StockItemDescription\">\r\n            <h3>Artikel beschrijving</h3>\r\n            <p><?php print $StockItem['SearchDetails']; ?></p>\r\n        </div>\r\n        <div id=\"StockItemSpecifications\">\r\n            <h3>Artikel specificaties</h3>\r\n            <?php\r\n            $CustomFields = json_decode($StockItem['CustomFields'], true);\r\n            if (is_array($CustomFields)) { ?>\r\n                <table>\r\n                <thead>\r\n                <th>Naam</th>\r\n                <th>Data</th>\r\n                </thead>\r\n                <?php\r\n                foreach ($CustomFields as $SpecName => $SpecText) { ?>\r\n                    <tr>\r\n                        <td>\r\n                            <?php print $SpecName; ?>\r\n                        </td>\r\n                        <td>\r\n                            <?php\r\n                            if (is_array($SpecText)) {\r\n                                foreach ($SpecText as $SubText) {\r\n                                    print $SubText . \" \";\r\n                                }\r\n                            } else {\r\n                                print $SpecText;\r\n                            }\r\n                            ?>\r\n                        </td>\r\n                    </tr>\r\n                <?php } ?>\r\n                </table><?php\r\n            } else { ?>\r\n\r\n                <p><?php print $StockItem['CustomFields']; ?>.</p>\r\n                <?php\r\n            }\r\n            ?>\r\n        </div>\r\n        <?php\r\n    } else {\r\n        ?><h2 id=\"ProductNotFound\">Het opgevraagde product is niet gevonden.</h2><?php\r\n    } ?>\r\n</div>\r\n\r\n<?php\r\ninclude \"cartfuncties.php\";\r\n?>\r\n<!DOCTYPE html>\r\n<html lang=\"nl\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <title>Artikelpagina (geef ?id=.. mee)</title>\r\n</head>\r\n<body>\r\n\r\n<?php\r\n//?id=1 handmatig meegeven via de URL (gebeurt normaal gesproken als je via overzicht op artikelpagina terechtkomt)\r\nif (isset($_GET[\"id\"])) {\r\n    $stockItemID = $_GET[\"id\"];\r\n} else {\r\n    $stockItemID = 0;\r\n}\r\n?>\r\n\r\n<!-- formulier via POST en niet GET om te zorgen dat refresh van pagina niet het artikel onbedoeld toevoegt-->\r\n<form method=\"post\">\r\n    <input type=\"number\" name=\"stockItemID\" value=\"<?php print($stockItemID) ?>\" hidden>\r\n    <input class=\"buttonOrange buttonOrange1\" type=\"submit\" name=\"submit\" value=\"Voeg toe aan winkelmandje\" style=\"margin:3%;margin-left:35%;width: 30%;\">\r\n</form>\r\n\r\n<?php\r\nif (isset($_POST[\"submit\"])) {              // zelfafhandelend formulier\r\n    $stockItemID = $_POST[\"stockItemID\"];\r\n    addProductToCart($stockItemID);         // maak gebruik van geïmporteerde functie uit cartfuncties.php\r\n    print(\"Product toegevoegd aan winkelmandje!</a>\");\r\n}\r\n?>\r\n\r\n</body>\r\n</html>\r\n<?php\r\ninclude __DIR__ . \"/footer.php\";\r\n?>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/view.php b/view.php
--- a/view.php	(revision 0ba07923cf511cd757ef137fcc7c1d6d019c7f7d)
+++ b/view.php	(date 1639138072751)
@@ -1,6 +1,7 @@
 <?php
 include __DIR__ . "/header.php";
 
+
 $StockItem = getStockItem($_GET['id'], $databaseConnection);
 $StockItemImage = getStockItemImage($_GET['id'], $databaseConnection);
 
@@ -15,6 +16,7 @@
 }
 
 ?>
+
 <div id="CenteredContent">
     <?php
     if ($StockItem != null) {
@@ -175,6 +177,10 @@
     print("Product toegevoegd aan winkelmandje!</a>");
 }
 ?>
+<?php
+print (temperatuur($databaseConnection))
+?>
+
 
 </body>
 </html>
